const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Chart-JHjBRS2W.js","assets/index-B1BljWgF.js","assets/index-D51zwkfA.css"])))=>i.map(i=>d[i]);
import{r as n,j as e,b as S,u as l,S as f,c as L,d as $,e as H,_ as R}from"./index-B1BljWgF.js";import{I as N}from"./InputWrapper-CuGz88GV.js";import{D as V,M as U,a as z,I as W,v as q,b as G,u as J,c as K,d as Q,P as X}from"./useToggleEvent-CJM58lR9.js";import{S as I,t as Y,a as D}from"./Separator-CUcbXHkB.js";import{P as w}from"./Primary-BYCnPxig.js";import{l as Z,d as T,e as ee,g as F,n as P,o as te,f as E,i as se,k as ae,u as ne,H as de,t as re}from"./useDocumentTitle-9eRnAQF4.js";import{B as C}from"./BudgetPotItem-B_kImZH4.js";import{T as oe}from"./Tertiary-BZVgm1YS.js";import{U as ue}from"./Avatar-e_BDgXeH.js";const ce={isBudgetsFormOpened:!1,setIsBudgetsFormOpened:()=>{},editBudget:null,setEditBudget:()=>{},deleteBudget:null,setDeleteBudget:()=>{}},h=n.createContext(ce);function O(){const s=n.useContext(h);if(s===void 0)throw new Error("useBudgetsPageContext must be used within a BudgetsPageContext Provider");return s}function ie({children:s}){const[t,r]=n.useState(!1),[o,d]=n.useState(null),[m,a]=n.useState(null),c={isBudgetsFormOpened:t,setIsBudgetsFormOpened:r,editBudget:o,setEditBudget:d,deleteBudget:m,setDeleteBudget:a};return e.jsx(h.Provider,{value:c,children:s})}function le(){const s=S(),t=n.useId(),r=n.useId(),o=n.useId(),{setIsBudgetsFormOpened:d,setEditBudget:m,editBudget:a}=n.useContext(h),[c,B]=n.useState(a?a.maximum:0),[g,j]=n.useState(a?a.theme:"#277c78"),p=l(Z),b=n.useMemo(()=>p.map(i=>({value:i.toLowerCase(),label:i})),[p]),[x,v]=n.useState(a?a.category:b[0].value);let u=!x||!c;a&&(u=u||a.category===x&&a.maximum===c&&a.theme===g);function M(i){i.preventDefault(),!u&&(s(a?L({...a,category:x,maximum:c,theme:g}):$({id:q(),category:x,maximum:c,theme:g})),y())}function k(i){v(i.target.value)}function A(i){B(Number(i.target.value))}function _(i){j(i.target.value)}function y(){d(!1),m(null)}return e.jsxs(V,{closeModal:y,children:[e.jsx(U,{text:a?"Edit Budget":"Add New Budget",closeModal:y}),e.jsx(z,{text:a?"As your budgets change, feel free to update your spending limits.":"Choose a category to set a spending budget. These categories can help you monitor spending."}),e.jsxs("form",{className:"budgetform-form",onSubmit:M,children:[e.jsxs("div",{className:"budgetform-inputs",children:[e.jsx(N,{id:t,label:"Budget Category",icon:e.jsx(f,{path:"caret-down"}),children:e.jsx(I,{id:t,options:b,value:x,onChange:k})}),e.jsx(N,{id:r,label:"Maximum Spend",prefix:"$",children:e.jsx(W,{id:r,value:c,onChange:A})}),e.jsx(N,{id:o,label:"Theme",colorTag:g,icon:e.jsx(f,{path:"caret-down"}),children:e.jsx(I,{id:o,options:Y,value:g.toLowerCase(),onChange:_})})]}),e.jsx(w,{label:a?"Save Changes":"Add Budget",type:"submit",isDisabled:u})]})]})}function me(){const s=S(),{deleteBudget:t,setDeleteBudget:r}=n.useContext(h);function o(){s(H(t.id)),d()}function d(){r(null)}return t?e.jsx(G,{itemName:t.category,info:"Are you sure you want to delete this budget? This action cannot be reversed, and all the data inside it will be removed forever.",onClickDelete:o,closeModal:d}):e.jsx(e.Fragment,{})}const ge=n.lazy(()=>R(()=>import("./Chart-JHjBRS2W.js"),__vite__mapDeps([0,1,2])));function xe(){const s=l(T),t=l(ee),o=[{type:"pie",data:n.useMemo(()=>s.map(d=>({name:t[d].category,y:t[d].maximum,color:t[d].theme})),[t,s])}];return e.jsxs("section",{className:"budsummary",children:[e.jsx("div",{className:"budsummary-chart",children:e.jsx(n.Suspense,{fallback:e.jsx(e.Fragment,{}),children:e.jsx(ge,{series:o})})}),e.jsxs("div",{className:"budsummary-stats",children:[e.jsx("h2",{className:"budsummary-h2",children:"Spending Summary"}),e.jsx("div",{className:"budsummary-spend",children:s.map(d=>e.jsxs(n.Fragment,{children:[e.jsx(pe,{budgetId:d}),e.jsx(D,{})]},d))})]})]})}function pe({budgetId:s}){const t=l(c=>F(c,s)),r=l(c=>P(c,t.category)),{id:o,category:d,theme:m,maximum:a}=t;return e.jsx(C,{label:d,value:r,theme:m,total:a},o)}function he({budgetId:s}){const t=l(u=>F(u,s)),r=l(u=>P(u,t.category)),o=l(u=>te(u,t.category)),d=n.useId(),{setDeleteBudget:m,setIsBudgetsFormOpened:a,setEditBudget:c}=n.useContext(h),{refElem:B,floatElem:g}=J(),[j,p]=n.useState(!1);K(d,u=>{u.newState==="closed"&&p(!1)});function b(){p(!j)}const x=[{label:"Edit Budget",onClick:()=>{c(t),a(!0)}},{label:"Delete Budget",isDanger:!0,onClick:()=>m(t)}],v=t.maximum<=r?0:t.maximum-r;return e.jsxs("section",{className:"budgetcard-cont",children:[e.jsxs("header",{className:"budgetcard-head",children:[e.jsx("span",{style:{backgroundColor:t.theme},className:"budgetcard-head-theme"}),e.jsx("p",{className:"budgetcard-head-name ellip-text",children:t.category}),e.jsx("span",{ref:B,className:"budgetcard-head-icon",onClick:b,children:e.jsx(f,{path:"ellipsis"})}),j&&e.jsx("div",{id:d,ref:g,popover:"auto",children:e.jsx(Q,{options:x})})]}),e.jsxs("div",{className:"budgetcard-bar-cont",children:[e.jsxs("p",{className:"budgetcard-bar-max",children:["Maximum of $",E(t.maximum)]}),e.jsx(X,{percentage:r/t.maximum*100,theme:t.theme}),e.jsxs("div",{className:"budgetcard-spend",children:[e.jsx(C,{label:"Spent",value:r,theme:t.theme}),e.jsx(C,{label:"Remaining",value:v})]})]}),e.jsxs("div",{className:"budgetcard-latspend",children:[e.jsxs("div",{className:"budgetcard-latspend-head",children:[e.jsx("p",{className:"budgetcard-latspend-title",children:"Latest Spending"}),e.jsx(oe,{label:"See All",link:`/transactions?category=${t.category}`,icon:e.jsx(f,{path:"caret-right"})})]}),e.jsx("div",{className:"budgetcard-transactions",children:o.map(u=>e.jsxs(n.Fragment,{children:[e.jsx(je,{transId:u}),e.jsx(D,{})]},u))})]})]})}function je({transId:s}){const t=l(a=>se(a,s)),{avatar:r,name:o,amount:d,date:m}=t;return e.jsxs("div",{className:"budgetcard-transitem",children:[e.jsxs("div",{className:"budgetcard-transitem-user",children:[e.jsx(ue,{src:r,alt:o,name:o}),e.jsx("p",{className:"ellip-text",children:o})]}),e.jsxs("div",{className:"budgetcard-transitem-detail",children:[e.jsxs("p",{className:"budgetcard-transitem-amount",children:[d>0?"+":"-","$",E(Math.abs(d))]}),e.jsx("p",{className:"budgetcard-transitem-date",children:ae(m)})]})]})}function Te(){const s=l(T);return ne(re.budgets),e.jsxs(ie,{children:[e.jsxs("div",{className:"budgetspage",children:[e.jsx(be,{}),e.jsxs("div",{className:"budgetspage-grid",children:[e.jsx(xe,{}),e.jsx("div",{className:"budgetspage-budgets",children:s.map(t=>e.jsx(he,{budgetId:t},t))})]})]}),e.jsx(fe,{})]})}function be(){const{setIsBudgetsFormOpened:s}=O();function t(){s(!0)}return e.jsxs("div",{className:"budgetspage-top",children:[e.jsx(de,{text:"Budgets"}),e.jsx(w,{label:"+ Add New Budget",onClick:t})]})}function fe(){const{isBudgetsFormOpened:s,deleteBudget:t}=O();return s?e.jsx(le,{}):t?e.jsx(me,{}):e.jsx(e.Fragment,{})}export{Te as default};
