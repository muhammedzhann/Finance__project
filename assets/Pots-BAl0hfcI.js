import{r as a,b as I,j as t,S as k,f as O,g as W,u as M,h as R,i as H,w as B,k as V}from"./index-B1BljWgF.js";import{c as q,f as C,a as z,u as G,H as J,t as K}from"./useDocumentTitle-9eRnAQF4.js";import{P as T}from"./Primary-BYCnPxig.js";import{I as N}from"./InputWrapper-CuGz88GV.js";import{I as Q}from"./InputText-Dmrcm94f.js";import{D as A,M as y,a as F,I as S,v as U,u as X,c as Y,d as Z,P as D,b as _}from"./useToggleEvent-CJM58lR9.js";import{S as tt,t as et}from"./Separator-CUcbXHkB.js";import"./Tertiary-BZVgm1YS.js";const ot={isPotsFormOpened:!1,setIsPotsFormOpened:()=>{},editPot:null,setEditPot:()=>{},deletePot:null,setDeletePot:()=>{},addToPot:null,setAddToPot:()=>{},withdrawFromPot:null,setWithdrawFromPot:()=>{}},v=a.createContext(ot);function E(){const e=a.useContext(v);if(e===void 0)throw new Error("usePotsPageContext must be used within a PotsPageContext Provider");return e}function st(){const e=I(),o=a.useId(),d=a.useId(),m=a.useId(),{setIsPotsFormOpened:r,setEditPot:P,editPot:n}=a.useContext(v),[l,c]=a.useState(n?n.name:""),[i,u]=a.useState(n?n.target:0),[s,b]=a.useState(n?n.theme:"#277c78");let f=!l||i===0;n&&(f=f||n.name===l&&n.target===i&&n.theme===s);function g(j){f||(j.preventDefault(),e(n?W({...n,name:l,target:i,theme:s}):O({id:U(),name:l,total:0,target:i,theme:s})),w())}function x(j){j.target.value.length>30||c(j.target.value)}function h(j){u(Number(j.target.value))}function p(j){b(j.target.value)}function w(){r(!1),P(null)}return t.jsxs(A,{closeModal:w,children:[t.jsx(y,{text:n?"Edit Pot":"Add New Pot",closeModal:w}),t.jsx(F,{text:n?"If your saving targets change, feel free to update your pots.":"Create a pot to set savings targets. These can help keep you on track as you save for special purchases."}),t.jsxs("form",{className:"potform-form",onSubmit:g,children:[t.jsxs("div",{className:"potform-inputs",children:[t.jsx(N,{id:o,label:"Pot Name",helperText:`${30-l.length} characters left`,children:t.jsx(Q,{id:o,placeholder:"Pot Name",value:l,onChange:x,maxLength:30})}),t.jsx(N,{id:d,label:"Target",prefix:"$",children:t.jsx(S,{id:d,value:i,onChange:h})}),t.jsx(N,{id:m,label:"Theme",colorTag:s,icon:t.jsx(k,{path:"caret-down"}),children:t.jsx(tt,{id:m,options:et,value:s.toLowerCase(),onChange:p})})]}),t.jsx(T,{label:n?"Save Changes":"Add Pot",type:"submit",isDisabled:f})]})]})}function $({label:e,onClick:o}){return t.jsx("button",{className:"secondbtn",onClick:o,children:t.jsx("span",{className:"secondbtn-label ellip-text",children:e})})}function L(e){let o=e<10?3:4;return Number.isInteger(e)&&o--,e.toPrecision(o)}function at({potId:e}){const o=a.useId(),{setEditPot:d,setIsPotsFormOpened:m,setDeletePot:r,setAddToPot:P,setWithdrawFromPot:n}=a.useContext(v),{refElem:l,floatElem:c}=X(),[i,u]=a.useState(!1),s=M(p=>q(p,e));Y(o,p=>{p.newState==="closed"&&u(!1)});function b(){P(s)}function f(){n(s)}function g(){u(!i)}const x=s.total/s.target*100,h=[{label:"Edit Pot",onClick:()=>{d(s),m(!0)}},{label:"Delete Pot",isDanger:!0,onClick:()=>r(s)}];return t.jsxs("section",{className:"potcard",children:[t.jsxs("header",{className:"potcard-head",children:[t.jsx("span",{style:{backgroundColor:s.theme},className:"potcard-head-theme"}),t.jsx("p",{className:"potcard-head-name ellip-text",children:s.name}),t.jsx("span",{ref:l,className:"potcard-head-icon",onClick:g,children:t.jsx(k,{path:"ellipsis"})}),i&&t.jsx("div",{id:o,ref:c,popover:"auto",children:t.jsx(Z,{options:h})})]}),t.jsx("div",{className:"potcard-main",children:t.jsx("div",{className:"potcard-main-progress",children:t.jsx(D,{theme:s.theme,percentage:x,topLeftLabel:"Total Saved",topRightLabel:`$${C(s.total)}`,bottomLeftLabel:`${L(x)}%`,bottomRightLabel:`Target of $${C(s.target,0)}`})})}),t.jsxs("footer",{className:"potcard-footer",children:[t.jsx($,{label:"+ Add Money",onClick:b}),t.jsx($,{label:"Withdraw",onClick:f})]})]})}function nt({children:e}){const[o,d]=a.useState(!1),[m,r]=a.useState(null),[P,n]=a.useState(null),[l,c]=a.useState(null),[i,u]=a.useState(null),s={isPotsFormOpened:o,setIsPotsFormOpened:d,editPot:m,setEditPot:r,deletePot:P,setDeletePot:n,addToPot:l,setAddToPot:c,withdrawFromPot:i,setWithdrawFromPot:u};return t.jsx(v.Provider,{value:s,children:e})}function rt(){const e=I(),{deletePot:o,setDeletePot:d}=a.useContext(v);function m(){e(R(o.id)),r()}function r(){d(null)}return o?t.jsx(_,{info:"Are you sure you want to delete this pot? This action cannot be reversed, and all the data inside it will be removed forever.",itemName:o.name,onClickDelete:m,closeModal:r}):t.jsx(t.Fragment,{})}function it(){const e=a.useId(),o=I(),{addToPot:d,setAddToPot:m}=a.useContext(v),[r,P]=a.useState(0),{theme:n,name:l,total:c,target:i}=d,u=r<=0;function s(){m(null)}function b(h){let p=Number(h.target.value);const w=i-c;p>w&&(p=w),P(p)}function f(h){h.preventDefault(),!u&&(o(H({potId:d.id,amount:r})),s())}const g=(c+r)/i*100,x=c/i*100;return t.jsxs(A,{closeModal:s,children:[t.jsx(y,{text:`Add to ‘${l}’`,closeModal:s}),t.jsx(F,{text:"Add money to your pot to keep it separate from your main balance. As soon as you add this money, it will be deducted from your current balance."}),t.jsx("div",{className:"addtopot-progress","data-is-added":r>0,children:t.jsx(D,{theme:n,percentage:g,topLeftLabel:"New Amount",topRightLabel:`$${C(c+r)}`,bottomLeftLabel:`${L(g)}%`,bottomRightLabel:`Target of $${C(i,0)}`,splitPercentage:x})}),t.jsxs("form",{className:"addtopot-form",onSubmit:f,children:[t.jsx(N,{id:e,label:"Amount to Add",prefix:"$",children:t.jsx(S,{id:e,value:r,onChange:b,max:i-c})}),t.jsx(T,{label:"Confirm Addition",type:"submit",isDisabled:u})]})]})}function lt(){const e=a.useId(),o=I(),{withdrawFromPot:d,setWithdrawFromPot:m}=a.useContext(v),[r,P]=a.useState(0),{name:n,total:l,target:c}=d,i=r<=0;function u(){m(null)}function s(x){let h=Number(x.target.value);const p=l;h>p&&(h=p),P(h)}function b(x){x.preventDefault(),!i&&(o(B({potId:d.id,amount:r})),u())}const f=l/c*100,g=(l-r)/c*100;return t.jsxs(A,{closeModal:u,children:[t.jsx(y,{text:`Withdraw from ‘${n}’`,closeModal:u}),t.jsx(F,{text:"Withdraw from your pot to put money back in your main balance. This will reduce the amount you have in this pot."}),t.jsx("div",{className:"withdrawpot-progress","data-is-withdraw":r>0,children:t.jsx(D,{theme:"var(--c-red)",percentage:f,topLeftLabel:"New Amount",topRightLabel:`$${C(l-r)}`,bottomLeftLabel:`${L(g)}%`,bottomRightLabel:`Target of $${C(c,0)}`,splitPercentage:g})}),t.jsxs("form",{className:"withdrawpot-form",onSubmit:b,children:[t.jsx(N,{id:e,label:"Amount to Withdraw",prefix:"$",children:t.jsx(S,{id:e,value:r,onChange:s,max:l})}),t.jsx(T,{label:"Confirm Withdrawal",type:"submit",isDisabled:i})]})]})}function jt(){const e=V(z);return G(K.pots),t.jsxs(nt,{children:[t.jsxs("div",{className:"potspage",children:[t.jsx(dt,{}),t.jsx("div",{className:"potspage-grid",children:e.map(o=>t.jsx(at,{potId:o},o))})]}),t.jsx(ct,{}),t.jsx(rt,{})]})}function dt(){const{setIsPotsFormOpened:e}=E();function o(){e(!0)}return t.jsxs("div",{className:"potspage-top",children:[t.jsx(J,{text:"Pots"}),t.jsx(T,{label:"+ Add New Pot",onClick:o})]})}function ct(){const{isPotsFormOpened:e,addToPot:o,withdrawFromPot:d}=E();return e?t.jsx(st,{}):o?t.jsx(it,{}):d?t.jsx(lt,{}):t.jsx(t.Fragment,{})}export{jt as default};
